import { PrismaClient } from '@prisma/client'

const prisma = new PrismaClient()

/**
 * üîê IDENTIFIANTS DE CONNEXION DISPONIBLES APR√àS LE SEED :
 * 
 * 1. Compte Admin Principal:
 *    üìß Email: admin@colisso.fr
 *    üîë Mot de passe: admin123
 *    üë§ R√¥le: ADMIN
 * 
 * 2. Compte de Test Simple:
 *    üìß Email: test@test.com  
 *    üîë Mot de passe: admin123
 *    üë§ R√¥le: ADMIN
 * 
 * 3. Gestionnaire:
 *    üìß Email: sophie.manager@colisso.fr
 *    üîë Mot de passe: password
 *    üë§ R√¥le: MANAGER
 * 
 * 4. Utilisateurs normaux:
 *    üìß Email: julien.operateur@colisso.fr
 *    üîë Mot de passe: admin123
 *    üë§ R√¥le: USER
 * 
 *    üìß Email: marie.expeditrice@colisso.fr  
 *    üîë Mot de passe: admin123
 *    üë§ R√¥le: USER
 */

async function main() {
  console.log('üå± D√©but du seeding de la base de donn√©es...')

  // =====================
  // UTILISATEURS
  // =====================
  console.log('üë• Cr√©ation des utilisateurs...')
  console.log('')
  console.log('üîê Identifiants de test disponibles :')
  console.log('1. admin@colisso.fr / admin123 (ADMIN)')
  console.log('2. test@test.com / admin123 (ADMIN - Simple)')
  console.log('3. sophie.manager@colisso.fr / password (MANAGER)')
  console.log('4. julien.operateur@colisso.fr / admin123 (USER)')
  console.log('5. marie.expeditrice@colisso.fr / admin123 (USER)')
  console.log('')
  
  const users = await Promise.all([
    // Administrateur
    prisma.user.upsert({
      where: { email: 'admin@colisso.fr' },
      update: {
        name: 'Admin Colisso',
        password: '$2b$12$NNHvgyFWdXW/YUXnqFN2nu88lc6kIyXqgV9lYV5JfmLMyoPhYhAzK', // password: admin123
        role: 'ADMIN'
      },
      create: {
        name: 'Admin Colisso',
        email: 'admin@colisso.fr',
        password: '$2b$12$NNHvgyFWdXW/YUXnqFN2nu88lc6kIyXqgV9lYV5JfmLMyoPhYhAzK', // password: admin123
        role: 'ADMIN'
      }
    }),
    
    // Compte de test simple
    prisma.user.upsert({
      where: { email: 'test@test.com' },
      update: {
        name: 'Utilisateur Test',
        password: '$2b$12$NNHvgyFWdXW/YUXnqFN2nu88lc6kIyXqgV9lYV5JfmLMyoPhYhAzK', // password: admin123
        role: 'ADMIN'
      },
    create: {
        name: 'Utilisateur Test',
        email: 'test@test.com',
        password: '$2b$12$NNHvgyFWdXW/YUXnqFN2nu88lc6kIyXqgV9lYV5JfmLMyoPhYhAzK', // password: admin123
      role: 'ADMIN'
    }
    }),
    
    // Gestionnaires
    prisma.user.upsert({
      where: { email: 'sophie.manager@colisso.fr' },
      update: {
        name: 'Sophie Dubois',
        password: '$2b$12$YmPW8iB8Du4mXDA51AEm3edjhFPPqwnnGfrR84PNR.s8j1fyzr7ha', // password: password
        role: 'MANAGER'
      },
      create: {
        name: 'Sophie Dubois',
        email: 'sophie.manager@colisso.fr',
        password: '$2b$12$YmPW8iB8Du4mXDA51AEm3edjhFPPqwnnGfrR84PNR.s8j1fyzr7ha', // password: password
        role: 'MANAGER'
      }
    }),
    
    // Utilisateurs normaux
    prisma.user.upsert({
      where: { email: 'julien.operateur@colisso.fr' },
      update: {
        name: 'Julien Moreau',
        password: '$2b$12$NNHvgyFWdXW/YUXnqFN2nu88lc6kIyXqgV9lYV5JfmLMyoPhYhAzK', // password: admin123
        role: 'USER'
      },
      create: {
        name: 'Julien Moreau',
        email: 'julien.operateur@colisso.fr',
        password: '$2b$12$NNHvgyFWdXW/YUXnqFN2nu88lc6kIyXqgV9lYV5JfmLMyoPhYhAzK', // password: admin123
        role: 'USER'
      }
    }),
    
    prisma.user.upsert({
      where: { email: 'marie.expeditrice@colisso.fr' },
      update: {
        name: 'Marie Lefevre',
        password: '$2b$12$NNHvgyFWdXW/YUXnqFN2nu88lc6kIyXqgV9lYV5JfmLMyoPhYhAzK', // password: admin123
        role: 'USER'
      },
      create: {
        name: 'Marie Lefevre',
        email: 'marie.expeditrice@colisso.fr',
        password: '$2b$12$NNHvgyFWdXW/YUXnqFN2nu88lc6kIyXqgV9lYV5JfmLMyoPhYhAzK', // password: admin123
        role: 'USER'
      }
    })
  ])

  // =====================
  // CLIENTS
  // =====================
  console.log('üè¢ Cr√©ation des clients...')
  
  const clients = await Promise.all([
    // Clients fran√ßais
    prisma.client.upsert({
      where: { id: 'client-paris-1' },
      update: {},
      create: {
        id: 'client-paris-1',
        name: 'Jean Dupont',
        company: 'Entreprise Import-Export SARL',
        address: '123 Rue de la Paix, 75001 Paris',
        country: 'France',
        phone: '+33 1 23 45 67 89',
        email: 'j.dupont@import-export.fr',
        notes: 'Client VIP - Livraison prioritaire - Demande toujours un accus√© de r√©ception'
      }
    }),
    
    prisma.client.upsert({
      where: { id: 'client-lyon-1' },
      update: {},
      create: {
        id: 'client-lyon-1',
        name: 'Marie Martin',
        company: 'Soci√©t√© Distribution ABC',
        address: '456 Avenue des Champs, 69000 Lyon',
        country: 'France',
        phone: '+33 4 56 78 90 12',
        email: 'marie.martin@distribution-abc.fr',
        notes: 'Pr√©f√®re les livraisons en matin√©e'
      }
    }),
    
    prisma.client.upsert({
      where: { id: 'client-marseille-1' },
      update: {},
      create: {
        id: 'client-marseille-1',
        name: 'Pierre Durand',
        company: 'Commerce M√©diterran√©en',
        address: '789 Boulevard Central, 13000 Marseille',
        country: 'France',
        phone: '+33 4 91 23 45 67',
        email: 'p.durand@commerce-med.fr',
        notes: 'Livraison uniquement le matin - Portail automatique code 1234'
      }
    }),
    
    // Clients internationaux
    prisma.client.upsert({
      where: { id: 'client-senegal-1' },
      update: {},
      create: {
        id: 'client-senegal-1',
        name: 'Amadou Ba',
        company: 'Import Dakar',
        address: 'Avenue L√©opold S√©dar Senghor, Dakar',
        country: 'S√©n√©gal',
        phone: '+221 33 123 45 67',
        email: 'amadou.ba@importdakar.sn',
        notes: 'Client r√©gulier - Paiement toujours √† r√©ception'
      }
    }),
    
    prisma.client.upsert({
      where: { id: 'client-maroc-1' },
      update: {},
      create: {
        id: 'client-maroc-1',
        name: 'Fatima Benali',
        company: 'Trading Casablanca',
        address: 'Rue Mohammed V, Casablanca',
        country: 'Maroc',
        phone: '+212 522 12 34 56',
        email: 'f.benali@trading-casa.ma'
      }
    }),
    
    prisma.client.upsert({
      where: { id: 'client-tunisie-1' },
      update: {},
      create: {
        id: 'client-tunisie-1',
        name: 'Ahmed Trabelsi',
        address: 'Avenue Habib Bourguiba, Tunis',
        country: 'Tunisie',
        phone: '+216 71 12 34 56',
        email: 'ahmed.trabelsi@email.tn',
        notes: 'Attention: V√©rifier les documents douaniers'
      }
    }),
    
    prisma.client.upsert({
      where: { id: 'client-cote-ivoire-1' },
      update: {},
      create: {
        id: 'client-cote-ivoire-1',
        name: 'Kon√© Mamadou',
        company: 'Express Abidjan',
        address: 'Boulevard de la R√©publique, Abidjan',
        country: 'C√¥te d\'Ivoire',
        phone: '+225 01 23 45 67 89',
        email: 'kone.mamadou@express-abidjan.ci',
        notes: 'Livraison en zone franche - Pr√©voir documents sp√©ciaux'
      }
    }),
    
    // Clients particuliers
    prisma.client.upsert({
      where: { id: 'client-particulier-1' },
      update: {},
      create: {
        id: 'client-particulier-1',
        name: 'Lucie Bernard',
        address: '45 Rue des Lilas, 33000 Bordeaux',
        country: 'France',
        phone: '+33 5 56 78 90 12',
        email: 'lucie.bernard@gmail.com',
        notes: 'Particulier - Fragile avec pr√©caution'
      }
    }),
    
    prisma.client.upsert({
      where: { id: 'client-particulier-2' },
      update: {},
      create: {
        id: 'client-particulier-2',
        name: 'David Chen',
        address: '12 Rue de la Libert√©, 67000 Strasbourg',
        country: 'France',
        phone: '+33 3 88 12 34 56',
        email: 'david.chen@hotmail.fr',
        notes: 'Sonner √† l\'interphone - Appartement 3B'
      }
    })
  ])

  // =====================
  // √âTIQUETTES ET PACKAGES
  // =====================
  console.log('üè∑Ô∏è Cr√©ation des √©tiquettes et packages...')

  // √âtiquette 1 - Envoi vers le S√©n√©gal (GENERATED)
  const label1 = await prisma.label.upsert({
    where: { trackingId: 'COL-2024-001' },
    update: {
      clientId: clients[3].id, // Amadou Ba
      userId: users[1].id, // Utilisateur Test
      senderName: 'Colisso France',
      senderCity: 'Marseille',
      senderPhone: '+33760248507',
      recipientName: 'Amadou Ba',
      recipientCity: 'Dakar',
      recipientPhone: '+221 33 123 45 67',
      destination: 'S√©n√©gal',
      weight: 5.5,
      length: 40,
      width: 30,
      height: 25,
      serviceCode: '1049.00',
      serviceType: 'Sous 1 semaine | Colisso',
      cost: 89.99,
      status: 'GENERATED',
      paymentStatus: 'Pay√©'
    },
    create: {
      trackingId: 'COL-2024-001',
      clientId: clients[3].id, // Amadou Ba
      userId: users[1].id, // Utilisateur Test
      senderName: 'Colisso France',
      senderCity: 'Marseille',
      senderPhone: '+33760248507',
      recipientName: 'Amadou Ba',
      recipientCity: 'Dakar',
      recipientPhone: '+221 33 123 45 67',
      destination: 'S√©n√©gal',
      weight: 5.5,
      length: 40,
      width: 30,
      height: 25,
      serviceCode: '1049.00',
      serviceType: 'Sous 1 semaine | Colisso',
      cost: 89.99,
      status: 'GENERATED',
      paymentStatus: 'Pay√©'
    }
  })

  // Supprimer les packages existants pour cette √©tiquette et les recr√©er
  await prisma.package.deleteMany({ where: { labelId: label1.id } })
  await Promise.all([
    prisma.package.create({
      data: {
        labelId: label1.id,
        description: 'Produits cosm√©tiques',
        weight: 2.5,
        length: 25,
        width: 20,
        height: 15,
        value: 150.00,
        contents: 'Cr√®mes de beaut√©, parfums'
      }
    }),
    prisma.package.create({
      data: {
        labelId: label1.id,
        description: 'V√™tements',
        weight: 3.0,
        length: 35,
        width: 25,
        height: 10,
        value: 200.00,
        contents: 'Robes, chemises, accessoires'
      }
    })
  ])

  // √âtiquette 2 - Envoi vers le Maroc (SHIPPED)
  const label2 = await prisma.label.upsert({
    where: { trackingId: 'COL-2024-002' },
    update: {},
    create: {
      trackingId: 'COL-2024-002',
      clientId: clients[4].id, // Fatima Benali
      userId: users[1].id, // Utilisateur Test
      senderName: 'Colisso France',
      senderCity: 'Marseille',
      senderPhone: '+33760248507',
      recipientName: 'Fatima Benali',
      recipientCity: 'Casablanca',
      recipientPhone: '+212 522 12 34 56',
      destination: 'Maroc',
      weight: 12.0,
      length: 60,
      width: 40,
      height: 35,
      serviceCode: '1049.00',
      serviceType: 'Sous 1 semaine | Colisso',
      cost: 145.50,
      status: 'SHIPPED',
      paymentStatus: 'Pay√©'
    }
  })

  // Supprimer les packages existants pour cette √©tiquette et les recr√©er
  await prisma.package.deleteMany({ where: { labelId: label2.id } })
  await prisma.package.create({
    data: {
      labelId: label2.id,
      description: '√âquipements √©lectroniques',
      weight: 12.0,
      length: 60,
      width: 40,
      height: 35,
      value: 800.00,
      contents: 'Ordinateur portable, accessoires informatiques'
    }
  })

  // √âtiquette 3 - Envoi local France (DELIVERED)
  const label3 = await prisma.label.upsert({
    where: { trackingId: 'COL-2024-003' },
    update: {},
    create: {
      trackingId: 'COL-2024-003',
      clientId: clients[0].id, // Jean Dupont
      userId: users[1].id, // Utilisateur Test
      senderName: 'Colisso France',
      senderCity: 'Marseille',
      senderPhone: '+33760248507',
      recipientName: 'Jean Dupont',
      recipientCity: 'Paris',
      recipientPhone: '+33 1 23 45 67 89',
      destination: 'France',
      weight: 3.2,
      length: 35,
      width: 25,
      height: 15,
      serviceCode: '1048.00',
      serviceType: 'Express 24h | Colisso',
      cost: 45.00,
      status: 'DELIVERED',
      paymentStatus: 'Pay√©'
    }
  })

  // Supprimer les packages existants pour cette √©tiquette et les recr√©er
  await prisma.package.deleteMany({ where: { labelId: label3.id } })
  await prisma.package.create({
    data: {
      labelId: label3.id,
      description: 'Documents importants',
      weight: 3.2,
      length: 35,
      width: 25,
      height: 15,
      value: 0.00,
      contents: 'Contrats, certificats, documents l√©gaux'
    }
  })

  // √âtiquette 4 - Envoi vers la C√¥te d'Ivoire (PENDING)
  const label4 = await prisma.label.upsert({
    where: { trackingId: 'COL-2024-004' },
    update: {},
    create: {
      trackingId: 'COL-2024-004',
      clientId: clients[6].id, // Kon√© Mamadou
      userId: users[3].id, // Marie Lefevre
      senderName: 'Colisso France',
      senderCity: 'Marseille',
      senderPhone: '+33760248507',
      recipientName: 'Kon√© Mamadou',
      recipientCity: 'Abidjan',
      recipientPhone: '+225 01 23 45 67 89',
      destination: 'C√¥te d\'Ivoire',
      weight: 25.8,
      length: 80,
      width: 60,
      height: 45,
      serviceCode: '1049.00',
      serviceType: 'Sous 1 semaine | Colisso',
      cost: 285.75,
      status: 'PENDING',
      paymentStatus: 'En attente'
    }
  })

  // Supprimer les packages existants pour cette √©tiquette et les recr√©er
  await prisma.package.deleteMany({ where: { labelId: label4.id } })
  await Promise.all([
    prisma.package.create({
      data: {
        labelId: label4.id,
        description: 'Pi√®ces automobiles',
        weight: 15.0,
        length: 50,
        width: 40,
        height: 30,
        value: 1200.00,
        contents: 'Alternateur, courroies, filtres'
      }
    }),
    prisma.package.create({
      data: {
        labelId: label4.id,
        description: 'Outillage professionnel',
        weight: 10.8,
        length: 60,
        width: 30,
        height: 25,
        value: 650.00,
        contents: 'Cl√©s, tournevis, √©quipements m√©caniques'
      }
    })
  ])

  // √âtiquette 5 - Envoi particulier (DRAFT)
  const label5 = await prisma.label.upsert({
    where: { trackingId: 'COL-2024-005' },
    update: {},
    create: {
      trackingId: 'COL-2024-005',
      clientId: clients[7].id, // Lucie Bernard
      userId: users[1].id, // Utilisateur Test
      senderName: 'Colisso France',
      senderCity: 'Marseille',
      senderPhone: '+33760248507',
      recipientName: 'Lucie Bernard',
      recipientCity: 'Bordeaux',
      recipientPhone: '+33 5 56 78 90 12',
      destination: 'France',
      weight: 1.5,
      length: 25,
      width: 20,
      height: 8,
      serviceCode: '1047.00',
      serviceType: 'Standard | Colisso',
      cost: 25.99,
      status: 'DRAFT',
      paymentStatus: 'Non pay√©'
    }
  })

  // Supprimer les packages existants pour cette √©tiquette et les recr√©er
  await prisma.package.deleteMany({ where: { labelId: label5.id } })
  await prisma.package.create({
    data: {
      labelId: label5.id,
      description: 'Cadeau personnel',
      weight: 1.5,
      length: 25,
      width: 20,
      height: 8,
      value: 75.00,
      contents: 'Bijoux, carte personnalis√©e'
    }
  })

  // √âtiquette 6 - Envoi vers la Tunisie (CANCELLED)
  const label6 = await prisma.label.upsert({
    where: { trackingId: 'COL-2024-006' },
    update: {},
    create: {
      trackingId: 'COL-2024-006',
      clientId: clients[5].id, // Ahmed Trabelsi
      userId: users[3].id, // Marie Lefevre
      senderName: 'Colisso France',
      senderCity: 'Marseille',
      senderPhone: '+33760248507',
      recipientName: 'Ahmed Trabelsi',
      recipientCity: 'Tunis',
      recipientPhone: '+216 71 12 34 56',
      destination: 'Tunisie',
      weight: 8.2,
      length: 45,
      width: 35,
      height: 20,
      serviceCode: '1049.00',
      serviceType: 'Sous 1 semaine | Colisso',
      cost: 95.00,
      status: 'CANCELLED',
      paymentStatus: 'Rembours√©'
    }
  })

  // Supprimer les packages existants pour cette √©tiquette et les recr√©er
  await prisma.package.deleteMany({ where: { labelId: label6.id } })
  await prisma.package.create({
    data: {
      labelId: label6.id,
      description: 'Produits alimentaires',
      weight: 8.2,
      length: 45,
      width: 35,
      height: 20,
      value: 120.00,
      contents: 'Sp√©cialit√©s fran√ßaises, conserves'
    }
  })

  console.log('‚úÖ Seed termin√© avec succ√®s!')
  console.log(`üë• Utilisateurs cr√©√©s: ${users.length}`)
  console.log(`üè¢ Clients cr√©√©s: ${clients.length}`)
  console.log('üè∑Ô∏è √âtiquettes cr√©√©es: 6')
  console.log('üì¶ Packages cr√©√©s: 8')
  console.log('\nüìä R√©partition des statuts:')
  console.log('- DRAFT: 1')
  console.log('- PENDING: 1') 
  console.log('- GENERATED: 1')
  console.log('- SHIPPED: 1')
  console.log('- DELIVERED: 1')
  console.log('- CANCELLED: 1')
  console.log('\nüîê POUR TESTER LA CONNEXION:')
  console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê')
  console.log('üë§ Compte Admin Simple: test@test.com / admin123')
  console.log('üë§ Compte Admin Complet: admin@colisso.fr / admin123') 
  console.log('üë§ Gestionnaire: sophie.manager@colisso.fr / password')
  console.log('‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê')
  console.log('üåê Acc√©dez maintenant √†: http://localhost:3000/auth/signin')
}

main()
  .catch((e) => {
    console.error(e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })
